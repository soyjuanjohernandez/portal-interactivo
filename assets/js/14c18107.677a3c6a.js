"use strict";(self.webpackChunkportal_interactivo=self.webpackChunkportal_interactivo||[]).push([[6934],{46450:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var i=n(74848),r=n(28453);const o={sidebar_position:2},s="Autorizaci\xf3n de usuarios",l={id:"APIReferences/Capabilities/Autorizacion",title:"Autorizaci\xf3n de usuarios",description:"La autorizaci\xf3n del usuario describe el proceso de obtener el consentimiento de un usuario para acceder a la informaci\xf3n del usuario.Se basa en el mecanismo de autorizaci\xf3n est\xe1ndar de la industria OAuth2.0.En la plataforma Mini Program, los desarrolladores deben obtener el permiso de los usuarios en el Mini programa antes de obtener y usar su informaci\xf3n.",source:"@site/docs/APIReferences/Capabilities/Autorizacion.md",sourceDirName:"APIReferences/Capabilities",slug:"/APIReferences/Capabilities/Autorizacion",permalink:"/portal-interactivo/docs/APIReferences/Capabilities/Autorizacion",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Capacidades",permalink:"/portal-interactivo/docs/APIReferences/Capabilities/Capacidades"},next:{title:"Obtener informaci\xf3n b\xe1sica del usuario",permalink:"/portal-interactivo/docs/APIReferences/Capabilities/Informacion basica usuario"}},c={},d=[{value:"Guias de acceso",id:"guias-de-acceso",level:2},{value:"Flujo de acceso",id:"flujo-de-acceso",level:3},{value:"Obtener authcode",id:"obtener-authcode",level:2},{value:"Obtener accessToken",id:"obtener-accesstoken",level:2},{value:"Llamar al servidor Openapi",id:"llamar-al-servidor-openapi",level:2},{value:"Lista de la API",id:"lista-de-la-api",level:2},{value:"Preguntas frecuentes",id:"preguntas-frecuentes",level:2},{value:"M\xe1s informaci\xf3n",id:"m\xe1s-informaci\xf3n",level:2}];function t(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.h1,{id:"autorizaci\xf3n-de-usuarios",children:"Autorizaci\xf3n de usuarios"}),"\n",(0,i.jsx)(a.p,{children:"La autorizaci\xf3n del usuario describe el proceso de obtener el consentimiento de un usuario para acceder a la informaci\xf3n del usuario.Se basa en el mecanismo de autorizaci\xf3n est\xe1ndar de la industria OAuth2.0.En la plataforma Mini Program, los desarrolladores deben obtener el permiso de los usuarios en el Mini programa antes de obtener y usar su informaci\xf3n."}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:(0,i.jsx)(a.p,{children:"Nombre"})}),(0,i.jsx)("th",{children:(0,i.jsx)(a.p,{children:"Descripci\xf3n"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Alcance de la autorizaci\xf3n\r\n(alcance)"}),(0,i.jsx)("td",{children:"Un alcance representa el alcance de los permisos que los desarrolladores necesitan para solicitar la autorizaci\xf3n del usuario.Un alcance contiene al menos una interfaz API abierta o interfaz JSAPI.Una autorizaci\xf3n puede combinar m\xfaltiples \xe1mbitos para la autorizaci\xf3n combinada.Para obtener m\xe1s informaci\xf3n, consulte la descripci\xf3n del alcance en my.getAuthCode."})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"C\xf3digo de Autorizaci\xf3n\r\n(c\xf3digo de autenticaci\xf3n)"}),(0,i.jsx)("td",{children:"Credenciales de autorizaci\xf3n de usuario temporal.Despu\xe9s de obtenerlo, intercamb\xedlo r\xe1pidamente para el token de acceso mencionado a continuaci\xf3n."})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Token de acceso o token de autorizaci\xf3n\r\n(access_token o auth_token)"}),(0,i.jsx)("td",{children:"Credenciales de autorizaci\xf3n a largo plazo. Se utiliza para llamar a la puerta de enlace del sitio para llamar a la interfaz de autorizaci\xf3n del lado del servidor. Preste atenci\xf3n al alcance y la validez del token de autorizaci\xf3n."})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:"Actualizaci\xf3n\r\n(refresh_token)"}),(0,i.jsx)("td",{children:"Se utiliza para actualizar y obtener un nuevo token de acceso despu\xe9s de que expire el token de acceso.El token de actualizaci\xf3n tambi\xe9n tiene un per\xedodo de validez."})]})]}),"\n",(0,i.jsx)(a.h2,{id:"guias-de-acceso",children:"Guias de acceso"}),"\n",(0,i.jsx)(a.h3,{id:"flujo-de-acceso",children:"Flujo de acceso"}),"\n",(0,i.jsx)(a.p,{children:"Tomando la obtenci\xf3n de la informaci\xf3n del usuario como ejemplo. El flujo de acceso general se ilustra a continuaci\xf3n:"}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"Grafico general del flujo de obtenci\xf3n de informaci\xf3n",src:n(50170).A+"",width:"1492",height:"704"})}),"\n",(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:["El miniprogram hace el llamado al ",(0,i.jsx)(a.code,{children:"getAuthcode"})," JSAPI para obtener el c\xf3digo de autorizaci\xf3n (",(0,i.jsx)(a.code,{children:"AuthCode"}),") de la billetera [1.1]."]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:"El miniprogram hace el llamado a la API del servidor comercial con AuthCode [2]."}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:"El servidor comercial llama a Aplicando OpenApi y el servidor de plataforma autorizado devuelve el token de acceso [2.2]."}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)(a.p,{children:"El servidor comercial guarda el token de acceso y devuelve el resultado de la autorizaci\xf3n al mini programa [2.4]."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)("b",{children:"Nota: "}),"Para autorizar otra informaci\xf3n, use un alcance diferente para el par\xe1metro Scopes al llamar a ",(0,i.jsx)(a.code,{children:"GetAuthCode"}),"."]}),"\n",(0,i.jsx)(a.h2,{id:"obtener-authcode",children:"Obtener authcode"}),"\n",(0,i.jsx)(a.p,{children:"Puede obtener la autorizaci\xf3n del usuario llamando al my.getAuthcode JSAPI y obtener el AuthCode en la devoluci\xf3n de llamada de \xe9xito. Por ejemplo:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-js",children:"my.getAuthCode({\r\n  scopes: ['USER_ID'],\r\n  success: (res) => {\r\n    my.alert({\r\n      content: res.authCode,\r\n    });\r\n  },\r\n  failed: (res) => {\r\n      console.log(res.authErrorScopes)\r\n  },\r\n});\n"})}),"\n",(0,i.jsx)(a.h2,{id:"obtener-accesstoken",children:"Obtener accessToken"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:["Para comerciantes: antes de obtener un ",(0,i.jsx)(a.code,{children:"accesstoken"}),", necesita obtener un ",(0,i.jsx)(a.code,{children:"authcode"})," de la billetera. Entonces puede llamar al ",(0,i.jsx)(a.code,{children:"applyToken"})," Openapi a cambio de ",(0,i.jsx)(a.code,{children:"accessToken"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)(a.p,{children:["Para desarrolladores: los desarrolladores pueden intercambiar ",(0,i.jsx)(a.code,{children:"accessToken"})," y ",(0,i.jsx)(a.code,{children:"userId"})," con el ",(0,i.jsx)(a.code,{children:"authcode"})," obtenido."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(a.h2,{id:"llamar-al-servidor-openapi",children:"Llamar al servidor Openapi"}),"\n",(0,i.jsxs)(a.p,{children:["Despu\xe9s de obtener el ",(0,i.jsx)(a.code,{children:"AccessToken"}),", los desarrolladores pueden continuar utilizando el token de acceso para llamar a otras interfaces de autorizaci\xf3n. Preste atenci\xf3n al alcance del permiso y el per\xedodo de validez del token."]}),"\n",(0,i.jsx)(a.h2,{id:"lista-de-la-api",children:"Lista de la API"}),"\n",(0,i.jsxs)("table",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"JSAPI"})}),(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"Descripci\xf3n"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(a.a,{href:"https://miniprogram.alipay.com/docs/miniprogram/mpdev/api_openapi_getauthcode",children:"my.getAuthCode"})}),(0,i.jsx)("td",{children:"Obtiene el c\xf3digo de autorizaci\xf3n del usuario."})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"OpenAPI"})}),(0,i.jsx)("td",{children:(0,i.jsx)("b",{children:"Descripci\xf3n"})})]}),(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(0,i.jsx)(a.a,{href:"https://miniprogram.alipay.com/docs/miniprogram/mpdev/api_openapi_getauthcode",children:"v2/authorizations/applyToken"})}),(0,i.jsx)("td",{children:"Obtenga el token de acceso."})]})]}),"\n",(0,i.jsx)(a.h2,{id:"preguntas-frecuentes",children:"Preguntas frecuentes"}),"\n",(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)("b",{children:["\xbfPor qu\xe9 los desarrolladores deber\xedan usar ",(0,i.jsx)(a.code,{children:"my.getAuthcode"})," API?"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:"Toda la lectura y la redacci\xf3n de informaci\xf3n del usuario en la plataforma Mini Program solo se pueden usar despu\xe9s de obtener el consentimiento del usuario.La autorizaci\xf3n del usuario se basa en el mecanismo de autorizaci\xf3n est\xe1ndar de la industria OAuth2.0. Con este mecanismo, los desarrolladores pueden obtener informaci\xf3n del usuario en la plataforma Mini Program."}),"\n",(0,i.jsxs)(a.ol,{start:"2",children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsx)("b",{children:"\xbfPor qu\xe9 la API de autorizaci\xf3n del usuario no est\xe1 permitida en la primera pantalla del mini programa?"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:"Para crear una mejor experiencia de usuario en el mini program, no se permite la orientaci\xf3n de autorizaci\xf3n del usuario en la primera pantalla del mini program.La orientaci\xf3n para la autorizaci\xf3n del usuario debe administrarse despu\xe9s de que el usuario comprende completamente el contenido comercial del mini programa. Le recomendamos que agregue la autorizaci\xf3n de mini programa al proceso de negocio."}),"\n",(0,i.jsxs)(a.ol,{start:"3",children:["\n",(0,i.jsxs)(a.li,{children:["\n",(0,i.jsxs)("b",{children:["\xbfSe puede obtener el ",(0,i.jsx)(a.code,{children:"userId"})," a trav\xe9s de la API de autorizaci\xf3n del usuario?"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["No, el ",(0,i.jsx)(a.code,{children:"userId"})," debe obtenerse llamando a la API relacionada en el lado del servidor."]}),"\n",(0,i.jsx)(a.h2,{id:"m\xe1s-informaci\xf3n",children:"M\xe1s informaci\xf3n"}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.a,{href:"https://miniprogram.alipay.com/docs/miniprogram/mpdev/api_openapi_obtainbasicmemberinformation",children:"Obtener informaci\xf3n b\xe1sica del usuario"})})]})}function u(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},50170:(e,a,n)=>{n.d(a,{A:()=>i});const i=n.p+"assets/images/accesprocess-bd987bfb27d8ce1be43d73afb2673174.png"},28453:(e,a,n)=>{n.d(a,{R:()=>s,x:()=>l});var i=n(96540);const r={},o=i.createContext(r);function s(e){const a=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:a},e.children)}}}]);