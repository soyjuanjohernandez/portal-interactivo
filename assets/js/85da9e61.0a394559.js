"use strict";(self.webpackChunkportal_interactivo=self.webpackChunkportal_interactivo||[]).push([[8094],{87645:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>o});var s=r(74848),d=r(28453);const t={sidebar_position:3},i=void 0,l={id:"APIReferences/OpenAPIs/OpenAPI para comerciantes/Version v1/Pagos/reembolso-de-pagos-V1",title:"reembolso-de-pagos-V1",description:"/v1/payments/notifyPayment",source:"@site/docs/APIReferences/OpenAPIs/OpenAPI para comerciantes/Version v1/Pagos/reembolso-de-pagos-V1.md",sourceDirName:"APIReferences/OpenAPIs/OpenAPI para comerciantes/Version v1/Pagos",slug:"/APIReferences/OpenAPIs/OpenAPI para comerciantes/Version v1/Pagos/reembolso-de-pagos-V1",permalink:"/portal-interactivo/docs/APIReferences/OpenAPIs/OpenAPI para comerciantes/Version v1/Pagos/reembolso-de-pagos-V1",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"docsSidebar",previous:{title:"v1-pagos-consultaPago",permalink:"/portal-interactivo/docs/APIReferences/OpenAPIs/OpenAPI para comerciantes/Version v1/Pagos/v1-pagos-consultaPago"},next:{title:"Capacidades",permalink:"/portal-interactivo/docs/category/capacidades"}},a={},o=[{value:"/v1/payments/notifyPayment",id:"v1paymentsnotifypayment",level:2},{value:"Message structure",id:"message-structure",level:2},{value:"Request",id:"request",level:3},{value:"Response",id:"response",level:3},{value:"L\xf3gica del proceso de resultados",id:"l\xf3gica-del-proceso-de-resultados",level:4},{value:"Result",id:"result",level:3},{value:"Sample",id:"sample",level:2},{value:"Request",id:"request-1",level:4}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"v1paymentsnotifypayment",children:"/v1/payments/notifyPayment"}),"\n",(0,s.jsxs)(n.p,{children:["POST ",(0,s.jsx)(n.code,{children:"/v1/payments/notifyPayment"})]}),"\n",(0,s.jsxs)(n.p,{children:["La ",(0,s.jsx)(n.code,{children:"notifyPayment"})," La API se utiliza para notificar al resultado del pago a merchant/partner."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Para notificar al comerciante/asociar el resultado del pago cuando el procesamiento de pagos llega al estado final (Success/Fail)."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"No todos los escenarios comerciantes/socios necesitan recibir esta notificaci\xf3n.Como escenario de pago de sincronizaci\xf3n (B Scan C, Agreement Pay)."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"message-structure",children:"Message structure"}),"\n",(0,s.jsx)(n.h3,{id:"request",children:"Request"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Propiedad"}),(0,s.jsx)("th",{children:"Tipo de datos"}),(0,s.jsx)("th",{children:"Requerido"}),(0,s.jsx)("th",{children:"Descripci\xf3n"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"partnerId"}),(0,s.jsx)("td",{children:"String"}),(0,s.jsx)("td",{children:"Yes"}),(0,s.jsx)("td",{children:"El socio asignado por la billetera.\r\nMax.Longitud: 32 caracteres."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"paymentId"}),(0,s.jsx)("td",{children:"String "}),(0,s.jsx)("td",{children:"Yes"}),(0,s.jsx)("td",{children:"La identificaci\xf3n de pago para el pago original correspondiente.\r\nMax.Longitud: 64 caracteres."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"paymentRequestId"}),(0,s.jsx)("td",{children:"String "}),(0,s.jsx)("td",{children:"Yes"}),(0,s.jsx)("td",{children:"La identificaci\xf3n \xfanica de un pago generado por los comerciantes de billetera.Max.Longitud: 64 caracteres."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"paymentAmount"}),(0,s.jsx)("td",{children:"Amount"}),(0,s.jsx)("td",{children:"Yes"}),(0,s.jsx)("td",{children:"Monto del pedido para la visualizaci\xf3n de registros de consumo de usuario, p\xe1gina de resultados de pago."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"paymentTime"}),(0,s.jsx)("td",{children:"String/Datetime"}),(0,s.jsx)("td",{children:"No"}),(0,s.jsx)("td",{children:"Tiempo de \xe9xito del pago, que sigue al est\xe1ndar ISO 8601."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"paymentStatus"}),(0,s.jsx)("td",{children:"String"}),(0,s.jsx)("td",{children:"Yes"}),(0,s.jsx)("td",{children:"\xc9xito: el orden es sucedido.\r\nFALLO - El orden fallece."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"paymentFailReason"}),(0,s.jsx)("td",{children:"String "}),(0,s.jsx)("td",{children:"No"}),(0,s.jsx)("td",{children:"La orden de pago de la orden de pago cuando el pago de pagos es fallado.\r\nMax.Longitud: 256 caracteres..."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"extendInfo"}),(0,s.jsx)("td",{children:"String "}),(0,s.jsx)("td",{children:"No"}),(0,s.jsx)("td",{children:"La informaci\xf3n extendida, la billetera y el comerciante pueden poner informaci\xf3n extendida aqu\xed.\r\nMax.Longitud: 4096 caracteres."})]})]}),"\n",(0,s.jsx)(n.h3,{id:"response",children:"Response"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Propiedad"}),(0,s.jsx)("th",{children:"Tipo de datos"}),(0,s.jsx)("th",{children:"Requerido"}),(0,s.jsx)("th",{children:"Descripci\xf3n"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"result"}),(0,s.jsx)("td",{children:"Result"}),(0,s.jsx)("td",{children:"Yes"}),(0,s.jsx)("td",{children:"El resultado de la solicitud, que contiene informaci\xf3n relacionada con el resultado de la solicitud, como los c\xf3digos de estado y error."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"refundId"}),(0,s.jsx)("td",{children:"String "}),(0,s.jsx)("td",{children:"No\t"}),(0,s.jsx)("td",{children:"N\xfamero de pedido de reembolso \xfanico.Es obligatorio cuando el resultado.ResultStatus es S.\r\nMax.Longitud: 64 caracteres."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"refundTime\t"}),(0,s.jsx)("td",{children:"String/Datetime"}),(0,s.jsx)("td",{children:"No"}),(0,s.jsx)("td",{children:"Deducir dinero del tiempo de \xe9xito comercial, despu\xe9s de entonces comenzar\xe1 a reembolsar dinero al usuario.que sigue el est\xe1ndar ISO 8601.Es obligatorio cuando el resultado.ResultStatus es S."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"extendInfo\t"}),(0,s.jsx)("td",{children:"String \t"}),(0,s.jsx)("td",{children:"No"}),(0,s.jsx)("td",{children:"La informaci\xf3n extendida, la billetera y el comerciante pueden poner informaci\xf3n extendida aqu\xed.\r\nMax.Longitud: 4096 caracteres."})]})]}),"\n",(0,s.jsx)(n.h4,{id:"l\xf3gica-del-proceso-de-resultados",children:"L\xf3gica del proceso de resultados"}),"\n",(0,s.jsx)(n.p,{children:"Para diferentes resultados de solicitud, se deben realizar diferentes acciones. Consulte la siguiente lista para m\xe1s detalles:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Si el valor de ",(0,s.jsx)(n.strong,{children:"result.resultStatus"})," es ",(0,s.jsx)(n.strong,{children:"S"}),", tEl reembolso es exitoso, merchant/partner puede procesar como \xe9xito."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Si el valor de ",(0,s.jsx)(n.strong,{children:"result.resultStatus"})," es ",(0,s.jsx)(n.strong,{children:"F"}),", El reembolso ha fallado, como causado por la fecha de reembolso que excede la ventana de reembolso permitido (",(0,s.jsx)(n.strong,{children:"result.resultCode = REFUND_WINDOW_EXCEED"}),"), como el monto del reembolso mayor que el monto del pago, etc."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Si el valor de ",(0,s.jsx)(n.strong,{children:"result.resultStatus"})," es ",(0,s.jsx)(n.strong,{children:"U"}),", significa reembolso de excepci\xf3n desconocida, merchant/partner \xbfPuede la consulta de reembolso de llamadas? Interface/retry Interfaz de reembolso para consultar para obtener el resultado de reembolso.Lo que necesita notar es el siguiente:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Estado (inquiry/retry still get U)  can no configurado para fallar o \xe9xito en merchant/partner sistema."}),"\n",(0,s.jsx)(n.li,{children:"Estado (inquiry/retry still get U) no debe refund/charge a Usuario por fuera de l\xednea(Tal vez har\xe1 la p\xe9rdida de fondos)."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Si otra respuesta (casi nunca ocurre),merchant/partner deber\xeda procesar como t\xfa."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"result",children:"Result"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"No\t"}),(0,s.jsx)("th",{children:"Estado de resultados"}),(0,s.jsx)("th",{children:"C\xf3digo de resultados"}),(0,s.jsx)("th",{children:"Resultado"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"S\t"}),(0,s.jsx)("td",{children:"SUCCESS\t"}),(0,s.jsx)("td",{children:"\xc9xito."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"U\t"}),(0,s.jsx)("td",{children:"UNKNOWN_EXCEPTION\t"}),(0,s.jsx)("td",{children:"Se fall\xf3 una llamada API, que es causada por razones desconocidas."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"U\t"}),(0,s.jsx)("td",{children:"REQUEST_TRAFFIC_EXCEED_LIMIT\t"}),(0,s.jsx)("td",{children:"El tr\xe1fico de solicitud excede el l\xedmite."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"9"}),(0,s.jsx)("td",{children:"U\t"}),(0,s.jsx)("td",{children:"REFUND_IN_PROCESS\t"}),(0,s.jsx)("td",{children:"El reembolso est\xe1 bajo procesamiento."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"REPEAT_REQ_INCONSISTENT\t"}),(0,s.jsx)("td",{children:"Env\xedo repetido, y las solicitudes son inconsistentes."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"F\t"}),(0,s.jsx)("td",{children:"PROCESS_FAIL\t"}),(0,s.jsx)("td",{children:"Se produjo una falla comercial general.No vuelva a intentarlo."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"F\t"}),(0,s.jsx)("td",{children:"PARAM_ILLEGAL\t"}),(0,s.jsx)("td",{children:"Existen par\xe1metros ilegales.Por ejemplo, una entrada no num\xe9rica o una fecha no v\xe1lida."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"F\t"}),(0,s.jsx)("td",{children:"INVALID_API\t"}),(0,s.jsx)("td",{children:"La API llamada no es v\xe1lida o no activa."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"8"}),(0,s.jsx)("td",{children:"F\t"}),(0,s.jsx)("td",{children:"ACCESS_DENIED\t"}),(0,s.jsx)("td",{children:"El acceso se niega."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"10"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"PARTNER_STATUS_ABNORMAL"}),(0,s.jsx)("td",{children:"Estado de la pareja anormal."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"11"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"ORDER_NOT_EXIST\t"}),(0,s.jsx)("td",{children:"El orden no existe."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"12"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"ORDER_STATUS_INVALID\t"}),(0,s.jsx)("td",{children:"El estado del pedido no es v\xe1lido."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"13"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"REFUND_WINDOW_EXCEED\t"}),(0,s.jsx)("td",{children:"Exceder la ventana de reembolso."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"14"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"REFUND_AMOUNT_EXCEED\t"}),(0,s.jsx)("td",{children:"El monto total de reembolso ha excedido el monto del pago."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"15"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"PARTNER_BALANCE_NOT_ENOUGH\t"}),(0,s.jsx)("td",{children:"El saldo de socios no es suficiente."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"16"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"CURRENCY_NOT_SUPPORT\t"}),(0,s.jsx)("td",{children:"La moneda no es compatible."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"17"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"EXPIRED_AGENT_TOKEN"}),(0,s.jsx)("td",{children:"El token de acceso de Mini Program ha caducado."})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"18"}),(0,s.jsx)("td",{children:"F"}),(0,s.jsx)("td",{children:"INVALID_AGENT_TOKEN\t"}),(0,s.jsx)("td",{children:"El token de acceso del mini programa no es v\xe1lido."})]})]}),"\n",(0,s.jsx)(n.h2,{id:"sample",children:"Sample"}),"\n",(0,s.jsxs)(n.p,{children:["Por ejemplo, un usuario de billetera solicita un reembolso de 100 USD de un pago exitoso en merchant/partner. Entonces merchant/partner Llamar\xe1 a la API de reembolso a la billetera para reembolsar el monto al usuario.\r\n",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(56619).A+"",children:"Merchant_Payments"})]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"User could start refund request from the Mini Program or the merchant cashier \uff08Step 1)."}),"\n",(0,s.jsxs)(n.li,{children:["The merchant server calls ",(0,s.jsx)(n.code,{children:"/v1/payments/refund"})," interface to refund (Step 2)."]}),"\n",(0,s.jsx)(n.li,{children:"E-wallet returns the refund result to the merchant server (Step 3)."}),"\n",(0,s.jsx)(n.li,{children:"The merchant should return the refund result to the Mini Program or the merchant cashier (Step 4)."}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"request-1",children:"Request"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'{\r\n  "partnerId": "P000000000000001xxxx",\r\n  "refundRequestId": "2019112719074101000700000088881xxxx",\r\n  "paymentId": "201911271907410100070000009999xxxx",\r\n  "refundAmount": {\r\n    "currency": "USD",\r\n    "value": "10000"\r\n  },\r\n    "extendInfo": "{\\"customerBelongsTo\\":\\"siteNameExample\\"}"\r\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"partnerId"})," is the unique identifier of merchant/partner, assigned by wallte."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"refundRequestId"})," es la identificaci\xf3n \xfanica de esta solicitud de reembolso, generada por merchant/partner, merchant/partner debe asegurarse de que sea \xfanico, porque la billetera usar\xe1 ",(0,s.jsx)(n.strong,{children:"partnerId"})," y ",(0,s.jsx)(n.strong,{children:"refundRequestId"})," to do idempotent process."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"paymentId"})," es la identificaci\xf3n de pago generada por la billetera, que es el identificador de pago \xfanico asociado con este reembolso."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"refundAmount"})," describe 100 USD debe reembolsar al usuario, el monto del reembolso debe ser menor que origin payment amount. The amount to pay out for this ",(0,s.jsx)(n.strong,{children:"refund.refundAmount.currency"})," and ",(0,s.jsx)(n.strong,{children:"paymentAmount.currency"})," En la solicitud de pago son las mismas.Y si hay m\xfaltiples reembolsos Para un pago en particular, el monto total reembolsado exitoso no puede exceder el monto de pago en la transacci\xf3n de pago."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"extendInfo"}),", Incluye la llave - ",(0,s.jsx)(n.strong,{children:"customerBelongsTo"})," tLa billetera electr\xf3nica que usa el cliente. Correspondiente al campo '",(0,s.jsx)(n.strong,{children:"siteName"}),"' el obtenido de la API'",(0,s.jsx)(n.strong,{children:"my.getSiteInfo"}),"', En el mini escenario del programa, esto es obligatorio."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Nota"}),":"]}),"\n",(0,s.jsx)(n.p,{children:"paymentId y PaymentRequestid no puede vaciarse, la billetera tiene que averiguar la orden de pago de origen basada en PaymentId opaymentRequestId."}),"\n",(0,s.jsx)(n.p,{children:"Response"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'{\r\n  "result": {\r\n    "resultCode": "SUCCESS",\r\n    "resultStatus": "S",\r\n    "resultMessage": "success"\r\n  },\r\n  "refundId": "2019112719074101000700000019000xxxx",\r\n  "refundTime": "2019-11-27T12:01:01+08:30"\r\n}\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"result.resultStatus==S"})," muestra que el reembolso de la billetera es exitoso."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"refundId"})," se genera por billetera, identifica de manera \xfanica el reembolso."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"refundTime"})," describe la hora de \xe9xito de este reembolso."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},56619:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/files/Merchant_Payments-672d528d37994d932a0d2024520b7752.png"},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(96540);const d={},t=s.createContext(d);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);